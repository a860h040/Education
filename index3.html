<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tutorial Player</title>
  <style>
    body{font-family:system-ui,Segoe UI,Arial,sans-serif;margin:24px;max-width:980px}
    h1{margin:0 0 12px}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:14px}
    button{padding:10px 14px;border-radius:12px;border:1px solid #ddd;background:#fff;cursor:pointer;font-weight:800}
    button:hover{background:#f6f6f6}
    button.active{border-color:#000;box-shadow:0 1px 0 rgba(0,0,0,.10)}
    .card{border:1px solid #e6e6e6;border-radius:16px;padding:14px}
    video{width:100%;height:auto;border-radius:14px;background:#000}
    .small{color:#666;font-size:13px;margin-top:10px;line-height:1.35}
  </style>
</head>
<body>

  <h1>Tutorial Player</h1>

  <div class="row">
    <button id="btnT1">Tutorial 1</button>
    <button id="btnT2">Tutorial 2</button>
    <button id="btnT3">Tutorial 3</button>
  </div>

  <div class="card">
    <div id="status" class="small">Choose a tutorial to play.</div>

    <video id="player" controls playsinline preload="auto"></video>

    <!-- Hidden buffer video used only for preloading the next part -->
    <video id="buffer" preload="auto" playsinline muted style="display:none;"></video>
  </div>

  <script>
    const BASE = "https://raw.githubusercontent.com/a860h040/Education/main/";

    // Tutorial 1: 1 -> 2
    // Tutorial 2: 3 -> 4 -> 5 -> 6
    // Tutorial 3: 7 -> 8
    const PLAYLISTS = {
      t1: [
        { title: "Part 1", url: BASE + "1.mov" },
        { title: "Part 2", url: BASE + "2.mov" }
      ],
      t2: [
        { title: "Part 3", url: BASE + "3.mov" },
        { title: "Part 4", url: BASE + "4.mov" },
        { title: "Part 5", url: BASE + "5.mov" },
        { title: "Part 6", url: BASE + "6.mov" }
      ],
      t3: [
        { title: "Part 7", url: BASE + "7.mov" },
        { title: "Part 8", url: BASE + "8.mov" }
      ]
    };

    const btnT1  = document.getElementById("btnT1");
    const btnT2  = document.getElementById("btnT2");
    const btnT3  = document.getElementById("btnT3");
    const player = document.getElementById("player");
    const buffer = document.getElementById("buffer");
    const status = document.getElementById("status");

    let currentParts = [];
    let idx = 0;

    function setActive(which){
      btnT1.classList.toggle("active", which === "t1");
      btnT2.classList.toggle("active", which === "t2");
      btnT3.classList.toggle("active", which === "t3");
    }

    function preloadNext(i){
      const next = i + 1;
      if (next < currentParts.length) {
        buffer.src = currentParts[next].url;
        buffer.load();
      } else {
        buffer.removeAttribute("src");
        buffer.load();
      }
    }

    async function playPart(i){
      idx = i;
      const part = currentParts[idx];
      status.textContent = `Loading ${part.title}...`;

      // Preload next part ASAP
      preloadNext(idx);

      // Load current part cleanly
      player.pause();
      player.removeAttribute("src");
      player.load();

      player.src = part.url;
      player.load();

      try {
        await player.play();
        status.textContent = `Playing ${part.title}`;
      } catch {
        status.textContent = `Loaded ${part.title}. Press Play if it didnâ€™t start automatically.`;
      }
    }

    function startTutorial(key){
      currentParts = PLAYLISTS[key].slice();
      setActive(key);
      playPart(0);
    }

    // Auto-advance immediately
    player.addEventListener("ended", () => {
      const next = idx + 1;
      if (next < currentParts.length) {
        playPart(next);
      } else {
        status.textContent = "Finished.";
      }
    });

    btnT1.addEventListener("click", () => startTutorial("t1"));
    btnT2.addEventListener("click", () => startTutorial("t2"));
    btnT3.addEventListener("click", () => startTutorial("t3"));
  </script>

</body>
</html>
